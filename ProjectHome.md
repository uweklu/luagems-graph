Lua Programming Gems Code from "Building Data Structures and Iterators in Lua".